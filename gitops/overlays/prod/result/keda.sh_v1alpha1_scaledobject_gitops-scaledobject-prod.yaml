apiVersion: keda.sh/v1alpha1
kind: ScaledObject
metadata:
  labels:
    app: gitops
    app.kubernetes.io/name: gitops
  name: gitops-scaledobject-prod
  namespace: prod
spec:
  advanced:
    horizontalPodAutoscalerConfig:
      behavior:
        scaleDown:
          policies:
          - periodSeconds: 60
            type: Percent
            value: 50
          stabilizationWindowSeconds: 60
        scaleUp:
          policies:
          - periodSeconds: 60
            type: Pods
            value: 4
          stabilizationWindowSeconds: 0
  cooldownPeriod: 30
  maxReplicaCount: 5
  minReplicaCount: 0
  pollingInterval: 15
  scaleTargetRef:
    apiVersion: argoproj.io/v1alpha1
    kind: Rollout
    name: gitops-rollout-prod
  triggers:
  - metadata:
      type: Utilization
      value: "70"
    type: cpu
  - metadata:
      type: Utilization
      value: "75"
    type: memory
